4:18:00 PM [express] GET /api/user/demo-user/analytics/timeline 200 in 22ms :: []
Error generating growth timeline: TypeError: storage.all is not a function
    at AdvancedAnalyticsService.generateGrowthTimeline (/home/runner/workspace/server/analytics-service.ts:118:42)
    at AdvancedAnalyticsService.generatePatternVisualization (/home/runner/workspace/server/analytics-service.ts:185:35)
    at <anonymous> (/home/runner/workspace/server/routes.ts:993:48)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:365:14)
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:376:14)
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:421:3)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at <anonymous> (/home/runner/workspace/server/index.ts:46:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at urlencodedParser (/home/runner/workspace/node_modules/body-parser/lib/types/urlencoded.js:94:7)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at jsonParser (/home/runner/workspace/node_modules/body-parser/lib/types/json.js:113:7)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at expressInit (/home/runner/workspace/node_modules/express/lib/middleware/init.js:40:5)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at query (/home/runner/workspace/node_modules/express/lib/middleware/query.js:45:5)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/application.js:181:10)
    at Server.app (/home/runner/workspace/node_modules/express/lib/express.js:39:9)
    at Server.emit (node:events:524:28)
    at parserOnIncoming (node:_http_server:1141:12)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:118:17)
4:18:00 PM [express] GET /api/user/demo-user/analytics/patterns 200 in 3ms :: {"cyclicPatterns":[],"…
Error generating growth timeline: TypeError: storage.all is not a function
    at AdvancedAnalyticsService.generateGrowthTimeline (/home/runner/workspace/server/analytics-service.ts:118:42)
    at AdvancedAnalyticsService.generatePredictiveModel (/home/runner/workspace/server/analytics-service.ts:216:49)
    at <anonymous> (/home/runner/workspace/server/routes.ts:1007:51)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:365:14)
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:376:14)
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:421:3)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at <anonymous> (/home/runner/workspace/server/index.ts:46:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at urlencodedParser (/home/runner/workspace/node_modules/body-parser/lib/types/urlencoded.js:94:7)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at jsonParser (/home/runner/workspace/node_modules/body-parser/lib/types/json.js:113:7)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at expressInit (/home/runner/workspace/node_modules/express/lib/middleware/init.js:40:5)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at query (/home/runner/workspace/node_modules/express/lib/middleware/query.js:45:5)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/application.js:181:10)
    at Server.app (/home/runner/workspace/node_modules/express/lib/express.js:39:9)
    at Server.emit (node:events:524:28)
    at parserOnIncoming (node:_http_server:1141:12)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:118:17)
4:18:00 PM [express] GET /api/user/demo-user/analytics/predictions 200 in 2ms :: {"phaseTransitionPr…
Storage.all called with query: 
        SELECT * FROM energy_patterns 
        WHERE user_id = $1 
        ORDER BY date DESC 
    
Storage.all called with query: 
        SELECT ai_insights FROM journal_entries 
        WHERE user_id = $1 
        ORDER BY creat
4:18:04 PM [express] GET /api/user/user123/growth 200 in 2ms :: {"userId":"user123","currentPhase":"…
Error extracting memories: AuthenticationError: 401 Incorrect API key provided: sk-or-v1*************************************************************599a. You can find your API key at https://platform.openai.com/account/api-keys.
    at Function.generate (/home/runner/workspace/node_modules/openai/src/core/error.ts:76:14)
    at OpenAI.makeStatusError (/home/runner/workspace/node_modules/openai/src/client.ts:463:28)
    at OpenAI.makeRequest (/home/runner/workspace/node_modules/openai/src/client.ts:713:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async EnhancedMemoryService.extractFromMessage (/home/runner/workspace/server/enhanced-memory-service.ts:36:26)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:83:3) {
  status: 401,
  headers: Headers {
    date: 'Thu, 09 Oct 2025 16:21:03 GMT',
    'content-type': 'application/json; charset=utf-8',
    'content-length': '323',
    connection: 'keep-alive',
    vary: 'Origin',
    'x-request-id': 'req_ed24d803163d4c45aae624846f47659c',
    'x-envoy-upstream-service-time': '27',
    'x-openai-proxy-wasm': 'v0.1',
    'cf-cache-status': 'DYNAMIC',
    'set-cookie': '__cf_bm=Hbjn4QTyAdhuB1gGOx0IMWb4C17INYLz_QYlKKJrcs4-1760026863-1.0.1.1-H1QbMEyn83H9u8azAjPyDeGGIisKzNlaMQUix1KSBbwoVVLeRxhKmaSJ1OmRCM8L3VZI7fLtbvMDneXYTbOYLYfovgMQjiVYza5nu8dETlY; path=/; expires=Thu, 09-Oct-25 16:51:03 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None, _cfuvid=N53AB0bf_0.Tn33PBUkxZu1TXbFCOK5GmNhY.ytZ3_4-1760026863865-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-content-type-options': 'nosniff',
    server: 'cloudflare',
    'cf-ray': '98bf357a0fc4fd8a-SEA',
    'alt-svc': 'h3=":443"; ma=86400'
  },
  requestID: 'req_ed24d803163d4c45aae624846f47659c',
  error: {
    message: 'Incorrect API key provided: sk-or-v1*************************************************************599a. You can find your API key at https://platform.openai.com/account/api-keys.',
    type: 'invalid_request_error',
    param: null,
    code: 'invalid_api_key'
  },
  code: 'invalid_api_key',
  param: null,
  type: 'invalid_request_error'
}
Adaptive chat error: AuthenticationError: 401 Incorrect API key provided: sk-or-v1*************************************************************599a. You can find your API key at https://platform.openai.com/account/api-keys.
    at Function.generate (/home/runner/workspace/node_modules/openai/src/core/error.ts:76:14)
    at OpenAI.makeStatusError (/home/runner/workspace/node_modules/openai/src/client.ts:463:28)
    at OpenAI.makeRequest (/home/runner/workspace/node_modules/openai/src/client.ts:713:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async ContradictionDetectionService.extractBeliefs (/home/runner/workspace/server/contradiction-detection-service.ts:35:22)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:86:3) {
  status: 401,
  headers: Headers {
    date: 'Thu, 09 Oct 2025 16:21:04 GMT',
    'content-type': 'application/json; charset=utf-8',
    'content-length': '323',
    connection: 'keep-alive',
    vary: 'Origin',
    'x-request-id': 'req_21698c34f22c431f8e49160e6c3849a5',
    'x-envoy-upstream-service-time': '21',
    'x-openai-proxy-wasm': 'v0.1',
    'cf-cache-status': 'DYNAMIC',
    'set-cookie': '__cf_bm=e82BqOa1H.m2XbaV3Wrd.0nufmgf9hypk19X3XSzUZw-1760026864-1.0.1.1-MrFaSfYF12ms5rF2XUjA_QvdA2L4.YHFFUNhcPgSITAy.0t6pVATsRyuYgBVvpHnZ1B4GPQfBNflnYwXNfACi9s45NsRv3P5XTVXwx5tdOI; path=/; expires=Thu, 09-Oct-25 16:51:04 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None, _cfuvid=PiwjHQB9H6.I6pkiHKK3cOoQ_gE4G7AsXLEQ8JTavEQ-1760026864002-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-content-type-options': 'nosniff',
    server: 'cloudflare',
    'cf-ray': '98bf357b7e83d44f-SEA',
    'alt-svc': 'h3=":443"; ma=86400'
  },
  requestID: 'req_21698c34f22c431f8e49160e6c3849a5',
  error: {
    message: 'Incorrect API key provided: sk-or-v1*************************************************************599a. You can find your API key at https://platform.openai.com/account/api-keys.',
    type: 'invalid_request_error',
    param: null,
    code: 'invalid_api_key'
  },
  code: 'invalid_api_key',
  param: null,
  type: 'invalid_request_error'
}
4:21:04 PM [express] POST /api/bliss/adaptive-chat 500 in 404ms :: {"error":"401 Incorrect API key p…
4:21:16 PM [express] GET /api/user/demo-user/chat-history 200 in 1ms :: [{"id":"1","title":"Explorin…
Storage.all called with query: 
        SELECT * FROM energy_patterns 
        WHERE user_id = $1 
        ORDER BY date DESC 
    
Storage.all called with query: 
        SELECT ai_insights FROM journal_entries 
        WHERE user_id = $1 
        ORDER BY creat
4:21:24 PM [express] GET /api/user/user123/growth 304 in 1ms :: {"userId":"user123","currentPhase":"…
4:21:53 PM [express] GET /api/belief-revisions 400 in 1ms :: {"error":"userId is required"}
4:21:53 PM [express] POST /api/memory/patterns 200 in 4ms :: {"memories":[],"patterns":[{"pattern":"…
4:21:53 PM [express] GET /api/conversation-themes 401 in 1ms
4:21:53 PM [express] GET /api/emotional-trajectory 401 in 1ms
4:22:19 PM [express] POST /api/memory/patterns 200 in 2ms :: {"memories":[],"patterns":[{"pattern":"…
Storage.all called with query: 
        SELECT * FROM energy_patterns 
        WHERE user_id = $1 
        ORDER BY date DESC 
    
Storage.all called with query: 
        SELECT ai_insights FROM journal_entries 
        WHERE user_id = $1 
        ORDER BY creat